<div class="post" *ngIf="(post$ | async) as post; else loadingTemplate">

    <div class="media" *ngIf="post.imgUrl || post.videoUrl">
        <img *ngIf="post.imgUrl" src="{{post.imgUrl}}" alt="mainPostPicture">
        <video *ngIf="post.videoUrl" controls>
            <source src="{{post.videoUrl}}" type="video/mp4">
            Dreams does not support the video tag.
        </video>
    </div>

    <ng-container *ngIf="(user$ | async) as userData">
        <ng-container *ngIf="userData; else wrongUserTemplate">
            <p class="username">U/{{ userData.username }}</p>
        </ng-container>
        <ng-template #wrongUserTemplate>
          <p class="username">U/unknown</p>
        </ng-template>
      </ng-container>
      
      <h2>{{ post.title }}</h2>
      
      <ng-container *ngIf="userMayEdit">
        <a routerLink="update" class="btn btn-primary">Edit</a>
      </ng-container>
    <hr>

    <div [innerHTML]="post.content"></div>
    <hr>

    <div *ngIf="post.reactions && post.reactions.length > 0">
      <h4>Reactions:</h4>
      <app-reactions (reactionSubmitted)="handlePostRefresh()" [postId]="post.id" [reactions]="post.reactions"></app-reactions>
    </div>
    <div *ngIf="!post.reactions || post.reactions.length === 0">
      <p>No reactions here.</p>
    </div>
    
</div>
<ng-template #loadingTemplate>
    <h2>Loading...</h2>
</ng-template>
